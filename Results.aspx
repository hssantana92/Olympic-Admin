<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Results.aspx.cs" Inherits="Sports_Management_System.Results" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
    <link href="bootstrap.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"/>
    <title>Event Results</title>
</head>
<body>
<form id="form1" runat="server">
     <div style="height:60px; background:#353535; color:white">
            <h1 style="text-align:center">Sports Management System</h1>
        </div>
        <div runat="server">
          <div class="row" runat="server">
            <div class="justify-content-center" style="background-color:#f0f0f0">
                <ul class="nav justify-content-center">
                  <li class="nav-item">
                    <a class="nav-link" href="Games.aspx">Games</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="Competitor.aspx">Competitors</a>
                  </li>
                  <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="Events.aspx" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Events
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item" href="Events.aspx">Events</a>
                      <a class="dropdown-item" href="Results.aspx">Results</a>
                    </div>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Reports</a>
                  </li>
                </ul>
                </div>
                <asp:GridView ID="EventCompetitorTable" 
                    CSSClass="table table-striped"
                    GridLines="None"
                    DataKeyNames="Result_ID"
                    autogeneratecolumns="False"
                    autogenerateeditbutton="true"
                    autogeneratedeletebutton="true"
                    emptydatatext="No data available." 
                    onRowDeleting="EventCompetitorTable_RowDeleting"
                    onRowCancelingEdit="EventCompetitorTable_RowCancelingEdit"
                    onRowUpdating="EventCompetitorTable_RowUpdating"
                    onRowDataBound="EventCompetitorTable_RowDataBound"
                    onRowEditing="EventCompetitorTable_RowEditing"
                    allowpaging="True" 
                    runat="server">
                    <Columns>
                        <%--Event ID--%>
                        <asp:TemplateField HeaderText="Event ID">
                            <ItemTemplate>
                                <%#Eval("Event_ID") %>
                            </ItemTemplate>

                            <EditItemTemplate>
                                <asp:DropDownList ID="EventIDDropDown" runat="server" />
                            </EditItemTemplate>
                        </asp:TemplateField>

                        <%--Competitor ID--%>
                        <asp:TemplateField HeaderText="Competitor ID">
                            <ItemTemplate>
                                <asp:Label ID="CompID" runat="server" Text='<%#Eval("Competitor_ID") %>'></asp:Label>
                            </ItemTemplate>
                            <EditItemTemplate>
                                <asp:DropDownList ID="CompetitorIDDropDown" runat="server" />
                            </EditItemTemplate>

                        </asp:TemplateField>
                        
                        <%--Name Text Box--%>
                        <asp:TemplateField HeaderText="Position">
                            <ItemTemplate>
                                <%#Eval("Competitor_Position") %>
                            </ItemTemplate>

                            <EditITemTemplate>
                                <asp:TextBox id="Competitor_Position"
                                    text='<%#Eval("Competitor_Position")%>'
                                    runat="server" />
                                </br>
                                <asp:RequiredFieldValidator
                                    ID="PositionRequiredValidator"
                                    runat="server"
                                    ControlToValidate="Competitor_Position"
                                    Display="Dynamic"
                                    Style="color: red; font-style:italic"
                                    ErrorMessage="Position required<br />"/>
                            </EditITemTemplate>
                        </asp:TemplateField>

                        <%--Competitor_Medal Dropdown--%>
                        <asp:TemplateField HeaderText="Competitor Medal">
                            <ItemTemplate>
                                <%#Eval("Competitor_Medal") %>
                            </ItemTemplate>
                        </asp:TemplateField>
                        </Columns>
                  </asp:GridView>
                <div style="text-align: -webkit-center;">
                <table runat="server">
                    <tr>
                        <td>
                            Event ID:<br />
                            <asp:DropDownList ID="DdlEventID" runat="server" />
                        </td>
                        <td style="width: auto">
                            Competitor:<br />
                            <asp:DropDownList ID="DdlCompetitorID" runat="server" />
                        </td>
                        <td style="width: auto">
                            Position:<br />
                            <asp:TextBox ID="TxtPosition" class="form-control form-control-sm" runat="server" Width="140" />
                        </td>
                        <td style="width: auto">
                            <asp:Button ID="InsertResult" style="margin-top:23px" ValidationGroup="InsertGroup" class="btn btn-primary btn-sm" runat="server" Text="Insert" OnClick="InsertResult_Click" />
                        </td>
                    </tr>
                </table>

                    <asp:CustomValidator 
                        ID="CompetitorValidator" 
                        runat="server" 
                        ValidationGroup="InsertGroup"
                        ControlToValidate="DdlCompetitorID"
                        Display="Dynamic"
                        Style="color: red; font-style:italic"
                        ErrorMessage="Competitor does not participate in the game associated with this event<br/>">
                    </asp:CustomValidator>

                    <asp:CustomValidator 
                        ID="EventDDLValidator" 
                        runat="server" 
                        ValidationGroup="InsertGroup"
                        ControlToValidate="DdlEventID"
                        Display="Dynamic"
                        Style="color: red; font-style:italic"
                        ErrorMessage="Event ID must be selected<br/>">
                    </asp:CustomValidator>

                    <asp:CustomValidator 
                        ID="CompetitorDDLValidator" 
                        runat="server" 
                        ValidationGroup="InsertGroup"
                        ControlToValidate="DdlCompetitorID"
                        Display="Dynamic"
                        Style="color: red; font-style:italic"
                        ErrorMessage="Competitor ID must be selected<br/>">
                    </asp:CustomValidator>

                    <asp:RequiredFieldValidator 
                        ID="PositionReqValidator" 
                        runat="server" 
                        ValidationGroup="InsertGroup"
                        ControlToValidate="TxtPosition"
                        Display="Dynamic"
                        Style="color: red; font-style:italic"
                        ErrorMessage="Position required"></asp:RequiredFieldValidator>
            </div>
              </div>
        </div>
    </form>
</body>
</html>
